{%- set _font_family = "monospace" -%}
{%- set _font_size = fonts[_font_family].sizes.big | scale(scaling.real) -%}

{%- set _bar_fonts = [fonts.sans_serif, fonts.icon] -%}

{%- set _monitor = monitors.outputs[notifications.monitor] -%}

{%- set _width = (_monitor.width * notifications.width) | scale(scaling.real) -%}
{%- set _height = (_monitor.height * notifications.height) | scale(scaling.real)-%}
{%- set _limit = (_monitor.height / _height) | round | int -%}
{%- set _icon_size = (_monitor.width * notifications.icon) | scale(scaling.real) -%}

{%- set _gap = (spacing.big * 2) | scale(scaling.real) -%}
{%- set _bar_size =
    [
        spacing.medium,
        spacing.medium / 2,
        _bar_fonts | map(attribute="sizes.medium") | max,
        spacing.medium / 2,
        spacing.medium,
    ] | sum | scale(scaling.real)
-%}

{%- set _spacing_small = spacing.small | scale(scaling.real) -%}
{%- set _spacing_medium = spacing.medium | scale(scaling.real) -%}
{%- set _spacing_big = spacing.big | scale(scaling.real) -%}

{%- macro _format_render(color) -%}
<span weight='bold' color='{{ color }}'>%a</span>\n<b>%s</b>\n%b
{%- endmacro -%}


[global]
monitor = {{ (monitors.outputs.keys() | list).index(notifications.monitor) }}
scale = 1
follow = none
transparency = 0
layer = overlay
force_xwayland = false

enable_posix_regex = false
enable_recursive_icon_lookup = true

origin = top-right
width = {{ _width }}
height = {{ _height }}
offset = {{ _gap }}x{{ _bar_size + _gap }}

progress_bar = true
progress_bar_horizontal_alignment = center
progress_bar_height = {{ _spacing_big + _spacing_small }}
progress_bar_frame_width = {{ _spacing_small }}
progress_bar_min_width = {{ _width - _gap }}
progress_bar_max_width = {{ _width - _gap }}
progress_bar_corner_radius = 0

icon_corner_radius = 0
icon_position = left
min_icon_size = {{ _icon_size }}
max_icon_size = {{ _icon_size }}
enable_recursive_icon_lookup = true
icon_theme = {{ icons.launcher.name }}
default_icon = /usr/share/icons/{{ icons.launcher.name }}/categories/32/applications-other.svg
# icon_path

padding = {{ _spacing_big }}
horizontal_padding = {{ _spacing_big }}
frame_width = {{ _spacing_medium }}
gap_size = {{ _spacing_big }}

corner_radius = 0
font = "{{ _font_family }} {{ _font_size }}px"
line_height = {{ _spacing_medium }}
format = "{{ _format_render(preset.foreground) }}"
vertical_alignment = center

mouse_left_click = "do_action"
mouse_middle_click = "context"
mouse_right_click = "close_current"

sort = urgency_ascending
word_wrap = true
alignment = center
markup = full

notification_limit = {{ _limit }}
indicate_hidden = true

idle_threshold = 0
# timeout = 24h
override_dbus_timeout = 24h
ignore_dbusclose = true

show_age_threshold = 0
hide_duplicate_count = false
show_indicators = true
ignore_newline = false
stack_duplicates = true
sticky_history = true
history_length = 40
dmenu = "/usr/bin/rofi -dmenu"


[global]
background = "{{ preset.inactive }}"
foreground = "{{ preset.foreground }}"
frame_color = "{{ preset.active }}"
highlight = "{{ preset.active }}"


[urgency_normal]
frame_color = "{{ preset.accent }}"
highlight = "{{ preset.accent }}"
format = "{{ _format_render(preset.accent) }}"


[urgency_critical]
frame_color = "{{ preset.important }}"
highlight = "{{ preset.important }}"
format = "{{ _format_render(preset.important) }}"
