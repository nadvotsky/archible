---
argument_specs:
  main:
    short_description: Common tasks role
    options:
      _common_packages:
        type: dict
        required: false
        description:
          - Packaging tasks.
        options:
          remove:
            type: list
            elements: str
            required: false
            description:
              - List of the packages to remove.
          force:
            type: bool
            required: false
            description:
              - Whenever to forcefully install package even if it already installed.
              - Might be useful to trigger installation hooks.
          sync:
            type: bool
            required: false
            description:
              - Whenever to sync package manager database.
          upgrade:
            type: bool
            required: false
            description:
              - Whenever to upgrade packages to their last version.
          install:
            type: list
            elements: str
            required: false
            description:
              - List of the packages to install. It also supports AURs.

      _common_install:
        type: dict
        required: false
        description:
          - Installation tasks (wiping, creating required directories, rendering files, etc).
        options:
          defaults: &common-install-opts
            type: dict
            description:
              - Sets default flags for all targets that did not specify it explicitly.
            options:
              become:
                type: bool
                required: false
                default: false
                description:
                  - Whenever to use the ansible 'become' mechanism.
              wipe:
                type: bool
                required: false
                default: false
                description:
                  - Whenever to wipe the directory the target belongs to.
              filemode:
                type: str
                required: false
                default: '0644'
                description:
                  - Permissions of the target file.
              dirmode:
                type: str
                required: false
                default: '0755'
                description:
                  - Permissions of the directory the target file belongs to.
                  - It may also create some intermediate directories.
              base:
                type: str
                required: false
                default: "{{ users.user.config }}"
                description:
                  - The base path for all targets that are not absolute.
          wipes:
            type: list
            elements: str
            required: false
            description:
              - An additional list of filesystem entries to wipe.
          targets:
            type: dict
            description:
              - A mapping of the target to its options.
              - >-
                Each key must either be relative or absolute path with at least two parts (so that dirname exists),
                consisting any of the following items: `become`, `wipe`, `filemode`, `dirmode`, and `base`,
                which have the same meaning as `defaults`, along with `content`, `template`, and `file`
                for specifying the source for the target, respectively.

      _common_services:
        type: dict
        required: false
        description:
          - Service manager.
        options:
          defaults:
            type: list
            elements: str
            required: false
            description:
              - Sets default flags for all targets that did not specify it explicitly.
              - >-
                'user' or 'system' switches between user and system manager instances.
              - >-
                'reload' requests the service manager to reload its configuration.
                Apparently useful it case of service configuration change.
              - >-
                'start' or 'stop' sets whether service must be restarted or stopped.
              - >-
                'mask' or 'unmask' sets whether it must be impossible to load the service
                even if it is a hard dependency of other services.
                There are the following possible scenarios according to the passed value:
                 - 'mask' => implies 'start'
                 - 'unmask' => implies 'stop'
                 - nothing => defaults to 'unmask', but without implying neither 'mask' nor 'stop'.
              - >-
                'enable' or 'disable' sets whether service must be enabled or disabled at startup automatically.
                Specifying 'enable' also implies 'start', and 'disable' implies 'stop'.
            choices:
              - user
              - system
              - reload
              - mask
              - unmask
              - enable
              - disable
              - stop
              - start
          targets:
            type: dict
            description:
              - A mapping of the target to its options.

      _common_gpg:
        type: str
        required: false
        description:
          - Retrieves previously generated GnuPG key metadata.

      _common_cmdline:
        type: dict
        required: false
        description:
          - Updates the kernel command-line parameters for the next boot.
          - Must be mapping, where each key denotes name of the parameter, and key its value.
          - >-
            Value may take several forms:
             - null (i.e. YAML `~` or empty) => rendered as `key`, previous keys are overwritten.
             - string => rendered as `key=value`, previous values are overwritten.
             - array => rendered as `key=value1,value2`, previous values are merged.

      _common_groups:
        type: list
        elements: str
        required: false
        description:
          - Adds the user to the specified list of groups.

      _common_environment:
        type: dict
        required: false
        description:
          - Modifies global system-wide /etc/environment file with the provided key-value pairs.
        elements: dict
        options:
          key:
            type: str
            required: true
            description:
              - Key of the environmental variable.
          value:
            type: str
            required: true
            description:
              - Value of the environmental variable.

